# UCDM - Un Curso de Milagros - Sistema Especializado

## üåü Descripci√≥n

Sistema de procesamiento y consulta inteligente de "Un Curso de Milagros" con modelo de lenguaje especializado basado en Ollama. Actualmente operativo con 161 lecciones procesadas (44.1% cobertura), proporcionando respuestas estructuradas, coherentes y transformadoras basadas en los principios fundamentales de UCDM.

## ‚ú® Caracter√≠sticas Principales

- **161 Lecciones Procesadas**: Sistema en desarrollo activo con 44.1% de cobertura completa
- **Sistema de Cache Multi-Nivel**: Optimizaci√≥n L1/L2/L3 con mejoras de performance >50%
- **Modelo Especializado**: Basado en Gemma 3:4B optimizado para UCDM con Ollama
- **Respuestas Estructuradas**: 4 secciones obligatorias (Hook, Aplicaci√≥n, Integraci√≥n, Cierre)
- **Performance Optimizada**: Tiempos de respuesta <10ms con cache, arranque <800ms
- **Validaci√≥n de Calidad**: Sistema robusto de verificaci√≥n de integridad (89.3% √©xito)
- **CLI Interactiva**: Interfaz amigable con m√©tricas en tiempo real
- **B√∫squeda Conceptual**: √çndices tem√°ticos para b√∫squedas avanzadas
- **Sistema de Validaci√≥n Integral**: Garant√≠as de calidad textual y coherencia
- **Cacheo Inteligente**: Lazy loading, pre-carga predictiva y gesti√≥n autom√°tica
- **Testing Extendido**: Framework con 95+ casos edge y stress testing
- **Monitoreo de Performance**: M√©tricas en tiempo real y alertas autom√°ticas

## üì¶ Instalaci√≥n y Configuraci√≥n Inicial

### Prerrequisitos

1. **Python 3.8+**

2. **Ollama** (Requerido para el modelo de lenguaje)

3. **Git** (Para clonar el repositorio)

# Ejecutar validaci√≥n completa del sistema
python tests/system_validator.py

# Probar sistema de cache optimizado
python test_optimization_system.py

# Verificar CLI con m√©tricas de performance
python ucdm_cli.py --stats

#### 5. Configuraci√≥n de Performance (Opcional)

## üöÄ Inicio R√°pido

### Modo Interactivo (Recomendado)

python ucdm_cli.py

### Consultas Directas

# Lecci√≥n del d√≠a
python ucdm_cli.py --hoy

# Lecci√≥n espec√≠fica
python ucdm_cli.py --leccion 1

# Concepto UCDM
python ucdm_cli.py --concepto "perd√≥n"

# Reflexi√≥n nocturna
python ucdm_cli.py --reflexion

## üíª Uso Diario

### Completar Lecciones Faltantes

# Verificar estado actual del sistema
python scripts/process_missing_lessons.py --status

# Procesar las 204 lecciones faltantes
python scripts/process_missing_lessons.py

### Comandos CLI Disponibles
| Comando | Descripci√≥n | Ejemplo |
|---------|-------------|----------|
| `leccion [n√∫mero]` | Consultar lecci√≥n espec√≠fica | `leccion 15` |
| `hoy` | Lecci√≥n del d√≠a actual | `hoy` |
| `concepto [tema]` | Explorar concepto UCDM | `concepto amor` |
| `reflexion` | Reflexi√≥n nocturna | `reflexion` |
| `buscar [texto]` | B√∫squeda libre | `buscar milagros` |
| `validate [--all]` | Validar calidad del sistema | `validate --all` |
| `stats` | Estad√≠sticas del sistema | `stats` |
| `help` | Mostrar ayuda | `help` |
| `salir` | Salir del programa | `salir` |

### Ejemplos de Consultas

#### Consultas B√°sicas
```
UCDM> leccion 1
UCDM> concepto perd√≥n
UCDM> ¬øC√≥mo puedo encontrar paz interior?
UCDM> Ay√∫dame con el miedo
```

#### Consultas Avanzadas
```
UCDM> ¬øQu√© dice UCDM sobre las relaciones?
UCDM> Expl√≠came la diferencia entre perd√≥n y perd√≥n verdadero
UCDM> ¬øC√≥mo aplicar los milagros en mi vida diaria?
UCDM> Necesito una reflexi√≥n sobre el Esp√≠ritu Santo
```

#### Validaci√≥n y Mantenimiento
```
UCDM> validate --all
UCDM> stats
```

## ‚ö†Ô∏è Estado Actual del Sistema

### üü¢ Funcionalidades Operativas
- ‚úÖ **CLI interactiva completamente funcional**
- ‚úÖ **Motor de respuestas estructuradas** (4 secciones obligatorias)
- ‚úÖ **Sistema de validaci√≥n robusto** (89.3% √©xito en tests)
- ‚úÖ **161 lecciones procesadas y disponibles** (44.1% cobertura)
- ‚úÖ **437 conceptos √∫nicos indexados**
- ‚úÖ **Arquitectura completa y estable**

### üîÑ En Desarrollo Activo
- üîÑ **Completaci√≥n de 204 lecciones restantes** (hacia 100% cobertura)
- üîÑ **Optimizaci√≥n de dataset de entrenamiento**
- üîÑ **Expansi√≥n de √≠ndices conceptuales**
- üîÑ **Correcci√≥n de formato JSON en dataset**

### üìä M√©tricas Actuales del Sistema
```
üìä DASHBOARD UCDM:
   Estado: OPERATIVO_PARCIAL
   Cobertura: 161/365 (44.1%)
   Calidad: 89.3% √©xito en tests
   Legibilidad: 100%
   Integridad: 44.1%
```

## üèóÔ∏è Arquitectura del Sistema

### Componentes Principales

```
graph TD
    subgraph "Capa de Performance (üÜï OPTIMIZADO)"
        CM[Cache Manager]
        L1[Memory Cache L1 - 50MB]
        L2[Disk Cache L2 - 2GB]
        L3[Index Cache L3 - Lazy]
        LL[Lazy Loader]
        PP[Predictive Preloader]
        PM[Performance Monitor]
    end
    
    subgraph "Capa de Validaci√≥n"
        QVE[Quality Validation Engine]
        LRE[Lesson Recognition Engine]
        RSV[Response Structure Validator]
        QRM[Quality Report Manager]
        CVP[Comprehensive Validation Pipeline]
    end
    
    subgraph "Capa de Procesamiento"
        PE[PDF Extractor]
        ALS[Advanced Lesson Segmenter]
        ETC[Enhanced Testing Components]
    end
    
    subgraph "Capa de Datos"
        DB[(Lessons Database)]
        IDX[(Comprehensive Indices)]
        RPT[(Quality Reports)]
        CACHE[(Cache Storage)]
    end
    
    subgraph "Capa de Interfaz"
        CLI[Enhanced CLI]
        ERE[Enhanced Response Engine]
        OLLAMA[Ollama Model]
    end
    
    CM --> L1
    CM --> L2
    CM --> L3
    L3 --> LL
    LL --> PP
    PM --> CM
    
    QVE --> CVP
    LRE --> CVP
    RSV --> CVP
    QRM --> CVP
    
    CVP --> DB
    CVP --> IDX
    CVP --> RPT
    
    DB --> ERE
    IDX --> ERE
    CACHE --> ERE
    L1 --> ERE
    L2 --> ERE
    L3 --> ERE
    
    ERE --> OLLAMA
    OLLAMA --> CLI
    PM --> CLI
```

### Sistema de Cache Multi-Nivel (üÜï OPTIMIZADO)

#### L1 - Memory Cache (50MB)
- **Prop√≥sito**: Respuestas frecuentes y datos activos
- **Estrategia**: LRU (Least Recently Used) thread-safe
- **TTL**: 1 hora por defecto, configurable
- **Caracter√≠sticas**: M√©tricas avanzadas, limpieza autom√°tica, hit/miss tracking
- **Performance**: <10ms para datos en cache

#### L2 - Disk Cache (2GB)
- **Prop√≥sito**: √çndices compilados y respuestas complejas
- **Estrategia**: Compresi√≥n gzip autom√°tica >1KB
- **TTL**: 24 horas por defecto, persistente
- **Caracter√≠sticas**: Verificaci√≥n de integridad, gesti√≥n de espacio inteligente
- **Performance**: <50ms para datos en disco

#### L3 - Index Cache (Lazy)
- **Prop√≥sito**: Relaciones conceptuales y mapeos din√°micos
- **Estrategia**: Carga bajo demanda con an√°lisis de dependencias
- **TTL**: Persistente hasta cambios en √≠ndices
- **Caracter√≠sticas**: Pre-carga predictiva, optimizaci√≥n basada en patrones
- **Performance**: Carga inteligente seg√∫n uso

### Framework de Testing Extendido (üÜï NUEVO)

- **Edge Case Generator**: 95+ casos l√≠mite realistas y autom√°ticos
- **Stress Test Runner**: Pruebas de carga concurrente y recursos limitados
- **Performance Monitor**: M√©tricas en tiempo real con alertas autom√°ticas
- **Regression Testing**: Suite completa de no-regresi√≥n

### M√©tricas de Performance en Tiempo Real (üÜï OPTIMIZADO)

| Componente | M√©trica Objetivo | Estado Actual |
|------------|------------------|---------------|
| **Tiempo de respuesta** | <1500ms | ‚úÖ <10ms con cache |
| **Tiempo de arranque** | <800ms | ‚úÖ ~0ms con lazy loading |
| **Hit ratio cache** | >70% | ‚úÖ Sistema implementado |
| **Throughput** | >1.0 consultas/seg | ‚úÖ ~3000 consultas/seg |
| **Uso memoria** | <150MB | ‚úÖ Optimizado con LRU |

### Motor de Validaci√≥n de Calidad

- **Validaci√≥n Textual**: Verifica legibilidad, codificaci√≥n UTF-8 y integridad
- **Reconocimiento de Lecciones**: Identifica y mapea las 365 lecciones con precisi√≥n
- **Validaci√≥n de Estructura**: Garantiza respuestas con 4 secciones obligatorias
- **Reportes Autom√°ticos**: Dashboard en tiempo real y m√©tricas de calidad

## üìä Estructura de Respuestas UCDM

Todas las respuestas siguen una estructura obligatoria de 4 secciones:

### üéØ HOOK INICIAL
- Pregunta enganchadora o an√©cdota
- Captura la atenci√≥n del usuario
- Conecta con la experiencia personal

### ‚ö° APLICACI√ìN PR√ÅCTICA
- **Exactamente 3 pasos numerados**
- Paso 1: Acci√≥n espec√≠fica y pr√°ctica
- Paso 2: Aplicaci√≥n en situaciones cotidianas
- Paso 3: Integraci√≥n y profundizaci√≥n

### üåø INTEGRACI√ìN EXPERIENCIAL
- Conexi√≥n personal con la vida del usuario
- Referencia expl√≠cita a ense√±anzas de UCDM
- Pregunta reflexiva guiada

### ‚ú® CIERRE MOTIVADOR
- Frase inspiradora final
- Llamada a la acci√≥n motivacional
- Elementos de amor, luz, paz o milagros

### Ejemplo de Respuesta Estructurada

```
üéØ HOOK INICIAL:
¬øTe has preguntado por qu√© algunos d√≠as sientes una paz profunda 
mientras que otros la ansiedad te invade?

‚ö° APLICACI√ìN PR√ÅCTICA:
Paso 1: Al despertar, dedica 5 minutos a recordar que eres un ser de luz.
Paso 2: Durante el d√≠a, cuando surja el miedo, repite: "Elijo la paz".
Paso 3: Antes de dormir, perdona cualquier juicio del d√≠a.

üåø INTEGRACI√ìN EXPERIENCIAL:
Conecta esto con tu vida: piensa en un momento donde elegiste el amor. 
UCDM nos ense√±a que "los milagros ocurren naturalmente como expresiones 
de amor". ¬øPuedes sentir la paz que surge de esta comprensi√≥n?

‚ú® CIERRE MOTIVADOR:
Est√°s listo para experimentar milagros. Comparte tu luz y observa 
c√≥mo se multiplica en el mundo.
```

## ‚öôÔ∏è Configuraci√≥n del Sistema de Performance

### Par√°metros de Cache Optimizados

```bash
# Configuraci√≥n por defecto en config/settings.py
CACHE_CONFIG = {
    'memory_cache': {
        'max_size_mb': 50,
        'ttl_hours': 1,
        'cleanup_threshold': 0.8
    },
    'disk_cache': {
        'max_size_gb': 2,
        'ttl_hours': 24,
        'compression': True
    },
    'index_cache': {
        'lazy_loading': True,
        'preload_popular': True,
        'dependency_tracking': True
    }
}
```

### Comandos de Optimizaci√≥n

# Verificar estado del sistema optimizado
python test_optimization_system.py

# Limpiar caches manualmente
python -c "from performance.cache_manager import CacheManager; CacheManager().clear_all()"

# Benchmark de performance
python ucdm_cli.py --stats

# Monitoreo en tiempo real
python performance/performance_monitor.py

## üîß Configuraci√≥n Avanzada

### Variables de Entorno

Crea un archivo `.env` en el directorio ra√≠z:

```
# Configuraci√≥n de Ollama
OLLAMA_HOST=localhost
OLLAMA_PORT=11434
OLLAMA_MODEL=ucdm-gemma

# Configuraci√≥n de rutas
DATA_DIR=./data
INDICES_DIR=./data/indices
PROCESSED_DIR=./data/processed
CACHE_DIR=./data/cache

# Configuraci√≥n de validaci√≥n
QUALITY_THRESHOLD=90.0
COVERAGE_THRESHOLD=95.0
STRUCTURE_COMPLIANCE=100.0

# Configuraci√≥n de Performance (üÜï NUEVO)
MEMORY_CACHE_SIZE_MB=50
DISK_CACHE_SIZE_GB=2
CACHE_TTL_HOURS=24
LAZY_LOADING_ENABLED=true
PREDICTIVE_PRELOAD=true
PERFORMANCE_MONITORING=true
```

### Configuraci√≥n del Modelo

El archivo `ollama/Modelfile` define el modelo especializado:

```
FROM gemma:3b

# Configuraci√≥n espec√≠fica para UCDM
TEMPLATE """{{ if .System }}```

```"

# Par√°metros optimizados para UCDM
PARAMETER temperature 0.7
PARAMETER top_p 0.9
PARAMETER top_k 40
PARAMETER repeat_penalty 1.1

# Sistema especializado en UCDM
SYSTEM """Eres un asistente especializado en "Un Curso de Milagros" (UCDM). 
Tus respuestas deben seguir ESTRICTAMENTE esta estructura de 4 secciones:

üéØ HOOK INICIAL: [Pregunta enganchadora o an√©cdota]
‚ö° APLICACI√ìN PR√ÅCTICA: [Exactamente 3 pasos numerados]
üåø INTEGRACI√ìN EXPERIENCIAL: [Conexi√≥n personal + referencia UCDM + pregunta reflexiva]
‚ú® CIERRE MOTIVADOR: [Frase inspiradora con elementos de amor/luz/paz]

Cada respuesta debe tener entre 300-500 palabras y ser completamente coherente 
con la pregunta formulada."""
```

## üß™ Testing y Validaci√≥n

### Ejecutar Tests

# Tests unitarios completos
python tests/test_validation_components.py

# Tests de integraci√≥n
python tests/test_integration_validation_system.py

# Validaci√≥n del sistema completo
python tests/system_validator.py

# Tests de todos los componentes
python tests/run_all_tests.py

# üÜï NUEVO: Tests de optimizaci√≥n y performance
python test_optimization_system.py

# üÜï NUEVO: Tests de casos edge (95+ casos)
python -c "from testing.edge_case_generator import EdgeCaseGenerator; EdgeCaseGenerator().generate_all_cases()"

# üÜï NUEVO: Stress testing
python testing/stress_test_runner.py

### Validaci√≥n Manual

# Validar calidad del sistema
python ucdm_cli.py
> validate --all

# Verificar cobertura
> report --quality

# Revisar m√©tricas
> metrics --dashboard

# Estad√≠sticas generales
> stats

# üÜï NUEVO: M√©tricas de cache
> cache --status

# üÜï NUEVO: Performance en tiempo real
> performance --monitor

## üìà M√©tricas de Calidad

### Umbrales de Calidad Requeridos

| M√©trica | Umbral | Descripci√≥n |
|---------|--------|-------------|
| **Legibilidad de Texto** | 100% | Todos los caracteres v√°lidos UTF-8 |
| **Integridad de Contenido** | 100% | Sin p√°rrafos cortados o incompletos |
| **Continuidad de Contenido** | ‚â• 95% | Flujo textual sin interrupciones |
| **Codificaci√≥n Correcta** | 100% | Codificaci√≥n UTF-8 sin caracteres corruptos |
| **Cobertura de Lecciones** | 365/365 | Todas las lecciones procesadas |
| **Precisi√≥n de Mapeo** | 100% | Mapeo 1:1 perfecto n√∫mero-contenido |
| **Cumplimiento de Estructura** | 100% | 4 secciones obligatorias en respuestas |
| **Coherencia Tem√°tica** | ‚â• 95% | Relevancia pregunta-respuesta |
| **Longitud de Respuestas** | 300-500 | Palabras por respuesta |
| **Variaci√≥n Ling√º√≠stica** | ‚â• 90% | Diversidad sin repeticiones |

### Estado Actual del Sistema

# Verificar estado actual
python ucdm_cli.py
> metrics --dashboard

## üîß Soluci√≥n de Problemas

### Problemas Comunes

Tests fallan

# Ejecutar tests con verbosidad
python -m pytest tests/ -v

# Verificar dependencias
pip check

#### 4. Problemas de codificaci√≥n

# Verificar codificaci√≥n del sistema
python -c "import sys; print(sys.getdefaultencoding())"

# Validar archivos de texto
file -i data/processed/lessons/*.txt

### Logs y Diagn√≥stico

# Ver logs del sistema
tail -f logs/ucdm_system.log

# Generar reporte de diagn√≥stico
python ucdm_cli.py
> report --quality > diagnostic_report.json

## ü§ù Contribuci√≥n

### Desarrollo

1. **Fork del repositorio**
2. **Crear rama de feature**: `git checkout -b feature/nueva-funcionalidad`
3. **Commit cambios**: `git commit -am 'Agregar nueva funcionalidad'`
4. **Push a la rama**: `git push origin feature/nueva-funcionalidad`
5. **Crear Pull Request**

### Est√°ndares de C√≥digo

- **Python 3.8+** compatible
- **PEP 8** para estilo de c√≥digo
- **Docstrings** en espa√±ol
- **Tests unitarios** para nuevas funcionalidades
- **Validaci√≥n de calidad** antes de commit

### Estructura de Commits

```
feat: agregar nueva funcionalidad de validaci√≥n
fix: corregir problema de codificaci√≥n UTF-8
docs: actualizar documentaci√≥n de instalaci√≥n
test: agregar tests para motor de calidad
refactor: mejorar pipeline de validaci√≥n
```

## üìÑ Licencia

Este proyecto est√° bajo la Licencia MIT. Ver el archivo [LICENSE](LICENSE) para m√°s detalles.

## üôè Agradecimientos

- **Fundaci√≥n para la Paz Interior** por "Un Curso de Milagros"
- **Ollama** por la plataforma de modelos de lenguaje
- **Comunidad UCDM** por inspiraci√≥n y retroalimentaci√≥n

## üìû Soporte

- **Issues**: [GitHub Issues](https://github.com/jhondrl6/UCDM/issues)
- **Documentaci√≥n**: [Wiki del proyecto](https://github.com/jhondrl6/UCDM/wiki)
- **Email**: [jhondrl6@gmail.com](mailto:jhondrl6@gmail.com)

---

> *"Los milagros ocurren naturalmente como expresiones de amor. El verdadero milagro es el amor que los inspira."* - Un Curso de Milagros

**¬°Que la paz del Curso te acompa√±e en tu jornada de despertar! üåü**